abstract from Keras  
less than 1000 lines  